import{p as m}from"./index-DJ2L1Pru.js";import{k as z,c as B,g as D,l as E,j as N,w as s,a,m as S,i as r,r as u,o as C,f as _,E as p}from"./index-4Wd1cmi8.js";const M={__name:"Content",setup(V){const c=r([]),d=r(!1),v=r(1),f=r(20),b=r(0);async function i(){d.value=!0;try{const{data:l}=await m.list({offset:(v.value-1)*f.value,limit:f.value});c.value=l.list||[],b.value=l.total||0}catch{c.value=[]}finally{d.value=!1}}async function w(l,e){var t,o;try{await m.updateStatus(l,e),p.success("已更新"),i()}catch(g){p.error(((o=(t=g.response)==null?void 0:t.data)==null?void 0:o.error)||"失败")}}async function k(l){var e,t;if(confirm("确定删除？"))try{await m.delete(l),p.success("已删除"),i()}catch(o){p.error(((t=(e=o.response)==null?void 0:e.data)==null?void 0:t.error)||"失败")}}return z(i),(l,e)=>{const t=u("el-table-column"),o=u("el-button"),g=u("el-table"),x=u("el-pagination"),h=S("loading");return C(),B("div",null,[e[4]||(e[4]=D("h2",{style:{margin:"0 0 20px"}},"内容管理",-1)),E((C(),N(g,{data:c.value,stripe:""},{default:s(()=>[a(t,{prop:"id",label:"ID",width:"80"}),a(t,{prop:"user_id",label:"用户ID",width:"100"}),a(t,{prop:"content",label:"内容","show-overflow-tooltip":""}),a(t,{prop:"status",label:"状态",width:"100"}),a(t,{prop:"created_at",label:"发布时间",width:"180"}),a(t,{label:"操作",width:"200",fixed:"right"},{default:s(({row:n})=>[a(o,{size:"small",onClick:y=>w(n.id,"hidden")},{default:s(()=>[...e[1]||(e[1]=[_("隐藏",-1)])]),_:1},8,["onClick"]),a(o,{size:"small",onClick:y=>w(n.id,"flagged")},{default:s(()=>[...e[2]||(e[2]=[_("标记",-1)])]),_:1},8,["onClick"]),a(o,{size:"small",type:"danger",onClick:y=>k(n.id)},{default:s(()=>[...e[3]||(e[3]=[_("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[h,d.value]]),a(x,{"current-page":v.value,"onUpdate:currentPage":e[0]||(e[0]=n=>v.value=n),"page-size":f.value,total:b.value,layout:"total, prev, pager, next",onCurrentChange:i,style:{"margin-top":"16px"}},null,8,["current-page","page-size","total"])])}}};export{M as default};
